# Упутство за контрибуторе

Овај репозиторијум представља пројектни задатак из предмета Принципи софтверског инжењерства на Електротехничком факултету Универзитета у Београду. За време израде пројекта само чланови тима могу да учествују у писању кодова, а након одбране пројекта репозиторијум ће бити отворен за свакога ко има *Github* налог.

Ово упутсво служи као подсетник за чланове тима у погледу техничких детаља у реализацији учешћа у раду на пројекту. Циљ овог документа је да олакша и убрза рад члановима тима пружајући решења за честе техничке проблеме и омогућавајући усмеравање фокуса ка суштини пројектног задатка.

## 1. Инсталирање неопходних програма

Потребно је инсталирати следеће програме:

1. [Git](https://git-scm.com/)
2. [Node.js](https://nodejs.org/en/)

## 2. Рад на пројекту

### 2.1. Врсте репозиторијума

#### 2.1.1. Главни репозиторијум

Назива се `upstream`<br/>
Налази се на линку: <https://github.com/psi-projekat/psi-projekat>

#### 2.1.2. Форкован репозиторијум

Назива се `origin`<br/>
Налази се на линку: `https://github.com/<username>/psi-projekat`<br/>
где `<username>` представља ваше корисничко име.<br/>
У даљем тексту сваки линк који садржи `<username>` то представља ваше корисничко име.

#### 2.1.3. Локални репозиторијум

Налази се на вашем рачунару.

## 2.2. Форковање репозиторијума

Да бисте направили било какву измену треба да форкујете главни репозиторијум на ваш *Github* налог. То се ради притиском на дугме *Fork* са странице главног репозиторијума:<br/> ![](https://user-images.githubusercontent.com/48075008/54875176-14583a80-4dfa-11e9-8b6f-b0a96b94ed28.png)

Репозиторијум је потребно форковати само једном. Уколико имате два репозиторијума на вашем налогу\* од којих се један зове `psi-projekat`, а други `psi-projekat-1`, то значи да сте два пута форковали репозиторијум. У том случају, да не би настали проблеми у даљем раду, обришите\** оба репозиторијума и форкујте главни репозиторијум поново.

<sub>
* Своје репозиторијуме можете видети на линку <code>https://github.com/&lt;username&gt;?tab=repositories</code><br/>
** Репозиторијум се брише тако што уђете на страницу свог форкованог репозиторијума,<br/>затим на картицу <code>Settings</code> и ту имате опцију <code>Delete this repository</code>
</sub>

## 2.3. Креирање локалног репозиторијума

Као и форковање, креирање локалног репозиторијума потребно је урадити само једном.

### 2.3.1. Иницијализација

Након форковања, на свом рачунару направите празан фолдер у коме желите да се налази ваш локални репозиторијум. Онда покрените *Command Prompt* и укуцајте

```
cd "C:\putanja\do\praznog\foldera"
```

где је `C:\putanja\do\praznog\foldera` путања до празног фолдера који сте креирали. Косе црте могу бити `/` или `\` и мора да садржи знакове навода око путање. Кад кликнете ентер требало би да добијете следећи резултат

```
C:\windows\system32>cd "C:\putanja\do\praznog\foldera"

C:\putanja\do\praznog\foldera>
```

Напомена: `C:\windows\system32` је најчешће почетни директоријум у ком се стартује *Command Prompt*, али то може да варира. Дакле, оно што је битно је да последња линија која се испише гласи `C:\putanja\do\praznog\foldera>`. То значи да је тај фолдер постављен за тренутни директоријум командне линије (команда `cd` - *"Current directory"*).

Након овога треба да иницијализујете празан локални репозиторијум командом `git init`

### 2.3.2. Додавање линкова ка главном и форкованом репозиторијуму

Након иницијализације треба да куцате следеће две команде (једну након друге):

```
git remote add u https://github.com/psi-projekat/psi-projekat
git remote add o https://github.com/<username>/psi-projekat
```

Обратите пажњу: `<username>` треба да замените вашим корисничким именом<br/>

Објашњење команди: `git remote` користи се за рад са удаљеним (дељеним) репозиторијумима. `git remote add` додаје нови линк ка удаљеном репозиторијуму. Овде смо додали два удаљена репозиторијума: главни (`upstream` - скраћено `u`) и форкован (`origin` - скраћено `o`).

Разлог за додавање линка ка главном репозиторијуму: када други чланови тима додају неку измену, они додају у главни репозиторијум (не директно, већ путем *Pull request*-а - о томе ће бити више речи касније). Ако не бисте имали линк ка главном репозиторијуми, не бисте могли да видите ту промену.

Разлог за додавање линка ка форкованом репозиторијуму: да бисте могли да отворите *Pull request*.

### 2.3.3. Довлачење садржаја

Сада је потребно довући садржај са главног и форкованог репозиторијума. То се ради следећим командама:

```
git fetch u
git fetch o
```

Након овога и даље нећете видети фајлове у локалном репозиторијуму, већ треба да извршите наредни корак - иницијализација главног *Branch*-а.

### 2.3.4. Иницијализација главног *Branch*-а

Главни *Branch* увек носи назив `master`. Иницијализација овог *Branch*-а врши се командом

```
git checkout -t o/master
```

Питање 1: зашто користимо `-t`?<br/>
Одговор 1: када први пут прелазите на неки *Branch* (у овом случају главни *Branch*), неопходно је параметром `-t` нагласити да желите да иницијализујете *Branch* у локалном репозиторијуму по угледу на истоимени *Branch* са форкованог репозиторијума.

Питање 2: зашто није `u/master`?<br/>
Одговор 2: зато што све промене које правите постављате на форкован репозиторијум, а не на главни. Тек када завршите са неким скупом измена, онда отворите *Pull request*, па се тек тада измене укључују у главни пројекат.

Овим је завршена фаза иницијализације. Још једном: ове кораке обављате само једном. У даљем тексту биће описано како манипулисати својим и туђим изменама и како синхронизовати удаљене репозиторијуме.

## 2.4. Креирање нове измене

Уколико желите да начините било какву измену (креирате нови фајл, обришете постојећи, измените неку скрипту, документ, ...), битно је пратити редом кораке описане у овој фази.

Прво што је битно нагласити је да све измене треба да правите у локалном репозиторијуму, а не у форкованом. То значи, на пример, ако желите да измените неки документ, можете ући на *Github* страницу вашег форкованог репозиторијума и *Github* ће вам дозволити да направите измену директо уређујући тај фајл у интернет претраживачу. Ово не треба радити из више разлога, неки од њих су: *Github* поставља *LF* прелазе између линија, што наш линтер не дозвољава (биће речи касније о томе), *Github* не омогућава увек исправну индентацију, не омогућава потпун капацитет *commit message*-а, не дозвољава директни *rebase*, итд. Дакле, све промене треба да правите у свом локалном репозиторијума на свом рачунару, а онда из командне линије да шаљете измене. Једино за шта користите *Github* је да отворите *Pull request* након измена.

Друга битна ствар: све измене треба да правите у посебним *Branch*-евима, а не на главном (`master`) *Branch*-у, иако је и `master` локални *Branch*. Разлог за то је да бисте могли да отворите више *Pull request*-ова истовремено, као и да бисте могли синхронизовати репозиторијум након што неко други дода своју измену.

Следе кораци који описују како исправно креирати нову измену.

### 2.4.1. Креирање новог *Branch*-а

Као што смо већ рекли, свака измена (односно скуп измена који има исти циљ) треба да буду у посебном *Branch*-у. Да бисте креирали нови *Branch*, из командне линије укуцајте:

```
git checkout -b naziv-brancha
```

Напомена: `naziv-brancha` замените називом тог *Branch*-а који креирате. Овај назив није нарочито битан, јер након укључивања измене у главни пројекат (што наравно долази тек касније), овај назив се нигде неће појављивати. Неопходно је водити рачуна да назив *Branch*-а мора бити без знакова размака, малим словима и са евентуалним цртицама.

### 2.4.2. Сама измена

Када сте прешли на нови *Branch*, можете у неком едитору текста направити измене које желите у локалном репозиторијуму. Отворите фајл који желите мењати или направите нови, додајте шта већ треба да се дода и сачувајте. Можете мењати произвољан број фајлова.

### 2.4.3. Комитовање измене

Ако сте завршили са свим релевантним изменама, из командне линије куцајте:

```
git add .
git commit
```

Након ове друге команде, отвориће се *VIM* едитор у самој командној линији:

![](https://user-images.githubusercontent.com/48075008/54875764-fa702500-4e04-11e9-916a-0bc112013113.png)

Ту треба да куцате наслов и садржај комита. Прво што треба да кликнете је <kbd>Insert</kbd> дугме на тастатури и треба да добијете овакав екран:

![](https://user-images.githubusercontent.com/48075008/54875769-170c5d00-4e05-11e9-964f-6b631d8ad78b.png)

Онда упишете наслов комита, оставите један ред празан и упишете опис комита:

![](https://user-images.githubusercontent.com/48075008/54875801-a87bcf00-4e05-11e9-89db-d901a5c45d1e.png)

Кад сте завршили са писањем наслова и описа, кликнете <kbd>Escape</kbd> на тастатури:

![](https://user-images.githubusercontent.com/48075008/54875815-dbbe5e00-4e05-11e9-9f9c-312f7b0e5866.png)

Затим укуцате `:wq`

![](https://user-images.githubusercontent.com/48075008/54875828-1aecaf00-4e06-11e9-8568-e2b0ce3cc9a7.png)

и на крају кликнете <kbd>Enter</kbd>. Треба да добијете нешто овако:

![](https://user-images.githubusercontent.com/48075008/54875837-3c4d9b00-4e06-11e9-9f9c-b3968a5518cd.png)

Овим сте успешно завршили комитовање измене коју сте направили.

Напомена: уколико је измена тривијална или из било ког разлога нема потребе да пишете опис измене, довољно је уместо `git commit` користити

```
git commit -m "Naslov komita"
```

У том случају неће се отворити *VIM* едитор, већ ће комит одмах бити сачуван. Ово је погодно за мање измене (на пример исправљање неких једноставних пропуста, правописних грешака, итд).

### 2.4.4. Проверавање комита

Ова фаза није неопходна, али је корисна и може се применити и у другим ситуацијама.

#### 2.4.4.1. Приказивање локалних *Branch*-ева

Постиже се командом `git branch`. Ова команда исписује све локалне *Branch*-еве и означава тренутни *Branch* посебном бојом.

#### 2.4.4.2. Приказивање удаљених *Branch*-ева

Команда `git branch -r`. Параметар `-r` значи *"remote"*.

#### 2.4.4.3. Приказивање тренутних измена

Команда `git status`. Пре него што направите измену, неће се приказати ништа. Кад направите измену, а пре него што извршите `git add`, приказаће се фајлови црвеном бојом. Кад извршите `git add`, а пре него што извршите `git commit` приказаће се фајлови зеленом бојом. Након `git commit` поново се неће приказати ништа. Ово последње је веома битно, кад комитујете измену, она се више не приказује у `git status`

#### 2.4.4.4. Приказивање историје

Команда `git log`. Исписује неколико последњих комита. Након што сте додали нови комит, он треба да се испише на врху. Да бисте изашли из `git log`, треба да притиснете <kbd>q</kbd>

### 2.4.5. Слање измене из локалног у форкован репозиторијум

Измена је додата у ваш локални репозиторијум, али није видљива другима. Да бисте је поделили са осталима, укуцате:

```
git push -u o naziv-brancha
```

Параметар `-u` (скраћено од `upstream`) не значи да додајете измену у главни (`upstream`) репозиторијум, већ овде има сасвим друго значење и односи се на повезивање локалног *Branch*-а са истоименим удаљеним *Branch*-ом на вашем форкованом репозиторијуму. По завршетку ове команде креираће се нови *Branch* у вашем форкованом репозиторијуму и садржаће измену коју сте локално направили.

Грешка која може да настане: `Updates were rejected because the remote contains work that you do not have locally`. То значи да нисте исправно синхронизовали репозиторијум (мада ово не би требало да се догоди уколико исправно пратите кораке) - погледати секцију 2.5.4.

### 2.4.6. Отварање *Pull request*-а

Последњи корак је отворити *Pull request* на главном репозиторијуму. То радите тако што уђете на страницу свог репозиторијума и кликнете `New pull request`

#### 2.4.6.1. Упоређивање репозиторијума

За `base repository` изаберите `psi-projekat/psi-projekat`, за `base branch` изаберите `master`, за `head repository` изаберите `<username>/psi-projekat` и за `head branch` изаберите `naziv-brancha`. Наравно, као и у претходним примерима, `<username>` је ваше корисничко име, а `naziv-brancha` је конкретан назив *Branch*-а који сте креирали.

Питање 1: да ли треба да уђем на свој форкован репозиторијум и кликнем `New pull request`, или треба то исто да кликнем на главном репозиторијуму?<br/>
Одговор 1: није битно, *Github* ће покушати сам да препозна који репозиторијум и који *Branch* имају новије измене, али ви то свакако можете променити накнадно.

#### 2.4.6.2. Наслов и опис

Пре него што отворите *Pull request*, било би добро да дате наслов и опис. Наслов ће се аутоматски поставити на наслов комита, а опис на опис комита (осим уколико сте додали комит са `commit -m`). У сваком случају, требало би да напишете шта тај *Pull request* представља, која је сврха измене, итд. Тек након тога отварате *Pull request* кликом на дугме `Create pull request` поново (први пут се отвара страница где можете да погледате измене и напишете опис и наслов, други пут кад кликнете отвара се *Pull request* - дугме ће бити са доње десне стране испод поља за унос текстуалног описа).

Отварањем *Pull request*-а завршена је фаза креирања измене. Шта се даље догађа пише у секцији *Pull request*

## 2.5. *Pull request*

### 2.5.1. Континуална интеграција

Чим отворите *Pull request* у позадини се аутоматски покрећу тестови који би требало да гарантују исправност и конзистентност измена које сте додали. Тај процес аутоматских тестова назива се континуална интеграција. У овом пројекту користимо *Travis* континуалну интеграцију.

Постоји више различитих тестова који се покрећу. У наставку су описани поједини тестови.<br/>
Напомена: тренутно имамо само линтер, али ћемо додати и друге тестове када за то дође време.

#### 2.5.1.1. Линтер

Ова врста тестова гарантује синтаксичку конзистентност текстуалних фајлова, кодова и документације. Сврха овог теста је да дефинише стандард који мора да се поштује у читавом репозиторијуму. Линтер не покреће сервер нити главни програм, он само проверава изглед кодова. Најчешће дефинише правила за следеће категорије.

##### 2.5.1.1.1. Индентација

Неко користи 2 размака за индентацију, неко 4, а неко 8. Такође, неко користи *tab*, а неко *space* као индентациони карактер. Линтер који користимо у овом пројекту захтева да индентација буде 2 размака.

##### 2.5.1.1.2. Прелази између линија

У текстуалним фајловима за прелаз између две линије (нови ред) користе се *ASCII* знакови са индексима *0x0D* и *0x0A*. Први се назива *CR* (carriage return), а други *LF* (line feed). У зависности од оперативног система користе се *CR* на *Mac* уређајима, *LF* на *Linux*-у и секвенца *CRLF* на *Windows*-у.

Сви модерни едитори текста омогућавају кориснику избор између ова три начина преласка у нови ред, без обзира на оперативни систем. Међутим, уколико је у неком фајлу већ коришћен један од ова три начина преласка у нови ред, едитор текста то детектује кад отворите фајл и наставља да користи тај исти начин у целом фајлу.

Линтер који користимо захтева *CRLF* прелаз.

Питање 1: континуална интеграција пријављује грешку `non-CRLF line break`, зашто се то дешава и како то да решим?<br/>
Одговор 1: то се најчешће дешава уколико сте писали ваш фајл директно у *Github* текст едитору у интернет претраживачу, јер према стандарду интернет претраживачи увек користе *LF* прелаз. Постоји много начина да се то исправи. Вероватно најједноставнији начин је да преузмете [HxD](https://mh-nexus.de/en/hxd/) програм и отворите ваш фајл у том програму. Онда идите на `Search -> Replace` и замените све бајтове *0A* секвенцом *0D0A* (детаљније у секцији 3.1).

##### 2.5.1.1.3. Формат кодова

Линтер такође дефинише правила везана за структуру самог кода (размак пре и после операнада у изразима, отворене блоковске заграде у истом реду са кључном речју, итд).

#### 2.5.1.2. Главни тест

Овај тест проверава разне функционалности сервера и веб апликације. Ово тренутно није имплементирано.

#### 2.5.1.3. Тест комита

Проверава исправност форматирања наслова и описа последњег комита. Ни ово тренутно није имплементирано.

### 2.5.2. Шта радити ако тест пријави грешку

Ако пише *"All checks have failed"* или *"Some checks have failed"*, кликните на `Details` линк који ће се појавити са десне стране тог теста. Отвориће се *Travis* сајт где можете видети грешку коју је тест пријавио.

Кад закључите зашто је тест пао и какву измену треба направити да се то реши, онда направите ту измену у свом локалном репозиторијуму (не на форкованом репозиторијуму преко *Github*-а, већ у свом локалном фолдеру на свом рачунару). Кад завршите са исправкама треба да додате те измене, али овога пута команде су мало другачије:

```
git add .
git commit -m "Naziv izmene"
git push o naziv-brancha
```

Овде је битно нагласити неколико ствари. Прво, не треба да креирате нови *Branch* нити да затворите *Pull request* који сте отворили. Једном када отворите *Pull request* он треба да остане отворен док се све грешке не исправе и док се измене не укључе у пројекат (а пре тога наравно сви тестови морају да прођу). Друга битна ствар је да овде не треба да стављате параметар `-u`

Још једном: након додавања измене ове три команде су све што треба да куцате (не треба она иницијализација, промена *Branch*-а, итд). Такође, не треба поново да отварате *Pull request*, већ се та нова измена коју сте додали аутоматски додаје у исти *Pull request* и тестови се аутоматски поново покрећу.

Кад сви тестови прођу, остали чланови тима могу да дају предлоге и сугестије везане за тај *Pull request*. Ако нико нема замерки на тај *Pull request*, он ће убрзо бити укључен у главни репозиторијум.

### 2.5.3. Преглед и оцена *Pull request*-а

Да би ваш *Pull request* био укључен у пројекат, сви чланови тима морају да одобре тај *Pull request*. Ако било ко има било какве примедбе, прво то мора бити разрешено. Пример једног *Pull request*-а изгледа овако:

![](https://user-images.githubusercontent.com/48075008/54888540-2e4b5900-4e9e-11e9-9494-52ce4b83fe09.png)

Преглед и оцена *Pull request*-а врши се кликом на картицу `Files changed` из горњег менија. Нема смисла оцењивати сопствени *Pull request*, већ то треба да ураде други чланови тима, али и ви треба да оцењујете туђе *Pull request*-е.

Кад отворите картицу `Files changed`, са горње десне стране имате опцију `Review changes`

![](https://user-images.githubusercontent.com/48075008/54888639-158f7300-4e9f-11e9-97f2-69e62a5f4584.png)

Ту можете додати опциони коментар (најчешће има смисла само ако имате неку примедбу на *Pull request*, у супротном коментар је углавном сувишан). Даље имате три опције:

1. `Comment` - остављате генералан коментар на *Pull request* без одобравања или захтевања измена (ако је на пример *Pull request* и даље у фази дораде или нисте сигурни да ли је та измена коју је неко поставио добра или није)
2. `Approve` - немате никаквих замерки на *Pull request*
3. `Request changes` - Постоје веома озбиљни проблеми у *Pull request*-у без чијих исправки не би те измене смеле да буду укључене у пројекат. У том случају неопходно је оставити коментар због чега је то ваша процена.

Још једном: Свако оцењује туђе *Pull request*-е, не своје. Након што прођу сви тестови и сви остали чланови тима одобре ваш *Pull request*, он ће бити укључен у пројекат.

Напомена: погледати секцију 4.1. - Надзор главног репозиторијума.

### 2.5.4. Након укључивања *Pull request*-а у главни репозиторијум

Кад ваш *Pull request* буде укључен у главни репозиторијум, то није крај. Преостали су кораци брисања *Branch*-а у форкованом, као и у локалном репозиторијуму. Прво бришете *Branch* у форкованом репозиторијуму командом:

```
git push --delete o naziv-brancha
```

Онда бришете локални *Branch*:

```
git checkout master
git branch -D naziv-brancha
```

Напомена: након брисања *Branch*-ева било би пожељно да погледате секције 2.4.4.1. и 2.4.4.2. и да потврдите да је *Branch* успешно обрисан. На крају, треба да синхронизујете репозиторијум (објашњено у секцији 2.6).

Питање 1: након што је мој *Pull request* укључен у главни пројекат и затворен, на дну странице пише *"Pull request successfully merged. You may delete your branch if you want"*. Да ли треба да кликнем то?<br/>
Одговор 1: не, то треба урадити преко командне линије, као што пише изнад. Ако сте то правилно урадили, не би то требало ни да вам пише на дну.

Питање 2: након што је мој *Pull request* укључен у главни пројекат и затворен, на дну странице пише *"Pull request successfully merged. You may delete your fork if you want"*. Да ли треба да кликнем то?<br/>
Одговор 2: не, дакле нема разлога за брисање форкованог репозиторијума докле год учествујете у пројекту.

### 2.5.5. Рад са више *Pull request*-ова

Честа пракса је да један члан тима отвори неколико *Pull request*-ова. Сваки *Pull request* захтева да имате посебан *Branch* у свом локалном репозиторијуму. Кад хоћете да радите на неком *Pull request*-у који сте претходно отворили, пре него што додате било коју измену у локалном репозиторијуму, треба да пређете на *Branch* који је повезан са тим *Pull request*-ом:

```
git checkout naziv-brancha
```

Питање 1: Случајно сам додао/ла измене у погрешан *Branch*, шта да радим?<br/>
Одговор 1: Постоје четири случаја:

1. Додали сте измене, али нисте куцали `git add` - у овом случају ако покушате да пређете на исправан *Branch* командом `git checkout` пријавиће вам грешку. То се решава тако што куцате `git stash` и након тога `git stash drop`. Онда ћете моћи да пређете на други *Branch*
2. Куцали сте `git add`, али нисте `git commit` - слично као претходни случај
3. Куцали сте `git commit`, али нисте `git push` - команда `git reset --hard o/naziv-brancha` решава проблем
4. Већ сте откуцали `git push` - вратите све измене које сте направили у том комиту и комитујте и *push*-ујте поново, а онда промените *Branch*

## 2.6. Синхронизација локалног репозиторијума

Пре него што одлучите да направите било коју измену у репозиторијуму, као и након што је ваш *Pull request* укључен у главни репозиторијум, потребно је синхронизовати ваш форковани, као и локални репозиторијум са главним. То се ради на следећи начин:

```
git checkout master
git fetch u
git pull u master
git push o master
```

Прва команда: прелазак на главни *Branch*<br/>
Друга команда: дохватање садржаја главног репозиторијума<br/>
Трећа команда: укључивање измена из главног репозиторијума у главни *Branch* локалног<br/>
Четврта команда: укључивање измена из локалног у форкован репозиторијум

Напомена: ово треба да урадите чак и ако је једина измена која је начињена у главном репозиторијуму била укључивање вашег *Pull request*-а (дакле тек кад ваш *Pull request* буде у потпуности укључен у главни пројекат и ви обришете ваш локални *Branch* са кога сте правили измене).

Још једном: синхронизацију вршите пре започињања било које измене која захтева нови *Branch* (односно нови *Pull request*).

# 3. Примери

## 3.1. Пример исправљања *CRLF* грешке

У претходном поглављу навели смо неке од грешака које могу да настану при тестирању и навели смо укратко како решити проблем *CRLF* грешке коришћењем *HxD* програма (постављен је и линк за преузимање). Дакле кораци су следећи: прво покренете *HxD*:

![](https://user-images.githubusercontent.com/48075008/54876843-0f55b400-4e17-11e9-974e-94e41e45d506.png)

Отворите проблематични фајл са диска одабиром опције `File -> Open`, добићете нешто овако:

![](https://user-images.githubusercontent.com/48075008/54876855-3c09cb80-4e17-11e9-9049-b08f63d7b407.png)

Даље идете на `Search -> Replace` и куцате следеће:

![](https://user-images.githubusercontent.com/48075008/54876868-6a87a680-4e17-11e9-93fc-a7c332cdfc40.png)

Кликнете на `Replace all` и у овом прозору који изађе кликнете *OK*:

![](https://user-images.githubusercontent.com/48075008/54876877-9efb6280-4e17-11e9-806d-265c84bc82fd.png)

Треба да добијете овако нешто (ови црвени бајтови представљају измењене вредности):

![](https://user-images.githubusercontent.com/48075008/54876911-17faba00-4e18-11e9-8de9-b91e454650a7.png)

Сачувате фајл, онда идете `git add` и `git commit`, а након тога и `git push` (наравно куцате целе команде, као што је написано у претходним поглављима).

## 3.2. Пример покретања локалних тестова

Континуална интеграција у суштини само покреће `test.bat`. То можете урадити и ви пре него што отворите *Pull request*, да не бисте касније морали да исправљате грешке.

## 3.3. Пример отварања два *Pull Request*-а

У овом примеру описаћемо како отворити два паралелна *Pull Request*-а за две различите измене и како ажурирати те *Pull Request*-ове док су они отворени.

### 3.3.1. Иницијализација

Претпоставимо да сте тек прочитали овај документ и хоћете на пример да додате своје ССУ документе како бисмо формално завршили другу фазу пројекта. Прво уђите на линк `https://github.com/<username>?tab=repositories` (замените `<username>` својим корисничким именом). Обришите све репозиторијуме које видите ту (значи `psi-projekat` и евентуално `psi-projekat-1` уколико сте два пута форковали). Ово брисање репозиторијума радите само једном да исправимо грешке које су настале раније због двоструког форковања.

Онда уђете на страницу главног репозиторијума и форкујете га. Пратите све кораке описане у претходним секцијама око форковања и касније иницијализације локалног репозиторијума. Дакле кад форкујете репозиторијум на свој профил, онда даље све куцате из командне линије. Прво наравно направите празан фолдер (ако сте то већ учинили пре читања овог документа, обришите све то, прочитајте цео документ, па следите кораке редом). Као што пише у претходним поглављима, кад направите нови празан фолдер, из командне линије уђете у тај фолдер командом `cd <putanja_do_foldera>`, затим куцате `git init`, `git remote add` и оне остале команде за иницијализацију и дохватање садржаја удаљених репозиторијума. Последња команда из те фазе је наравно `git checkout -t o/master`, чиме сте практично иницијализовали локални репозиторијум и сада сте спремни за додавање било каквих измена. Након што иницијализујете локални репозиторијум, до краја рада на пројекту нема потребе да бришете форковани репозиторијум, нити да форкујете поново, као ни да иницијализујете локални репозиторијум поново. Ово брисање и иницијализацију радите само ако сте то већ урадили пре читања овог документа.

### 3.3.2. Прва измена

#### 3.3.2.1. Прелазак на нови *Branch*

Као што смо рекли, претпоставимо да је прва измена коју желите да направите додавање ваших ССУ докумената. Прво креирате нови *Branch* коме дајете назив `ssu`

```
git checkout -b ssu
```

Сада је репозиторијум пребачен на нови *Branch* и све што додајете додајете у тај *Branch*. Онда додате ваше ССУ документе у фолдер `doc/projekat/ssu` (претпоставимо да имате своје документе сачуване негде, само идите *copy-paste* у овај фолдер). Онда из командне линије куцате `git status`, треба да видите фајлове које сте додали означене црвеном бојом.

#### 3.3.2.2. Покретање локалних тестова

Пре било каквих даљих измена можете покренути локалне тестове. То није неопходно, јер ће се тестови свакако покренути у континуалној интеграцији, али лакше вам је да исправите грешке одмах него касније, уколико из било ког разлога тестови не прођу. Тестове покрећете тако што из командне линије покренете `test.bat`, након чега треба да пише `All tests passed`

Питање 1: Мени пише `node is not recognized as an internal or external command, operable program or batch file`<br/>
Одговор 1: Потребно је инсталирати *Node.js*, као што пише на самом почетку овог документа. Након инсталације, изађите из командне линије и отворите командну линију поново (понекад је можда потребно рестартовати рачунар)

Питање 2: Тест не пролази, пише `Failed`<br/>
Одговор 2: Објаснићемо у наставку шта све може да буде узрок и како то исправити

#### 3.3.2.3. Без локалних тестова

Ако сте заборавили да покренете локалне тестове, или радите на рачунару на коме није инсталиран *Node.js*, није проблем. У наставку описаћемо управо ову ситуацију, односно када додате све ваше измене, а нисте покренули тестове и они не прођу у континуалној интеграцији. Ако покрећете тестове локално, треба да исправите све грешке пре него што куцате `git add` (односно пре ове команде треба да прођу сви тестови). Ако уопште нисте покренули локалне тестове, већ одмах *push*-овали измене на форкован репозиторијум и отворили *Pull request*, онда је исправљање грешака мало сложеније.

#### 3.3.2.4. Слање измена у форкован репозиторијум

Да се подсетимо у ком контексту се тренутно налазимо: прочитали сте овај документ, обрисали сте старе форковане репозиторијуме, форковали сте главни репозиторијум поново, иницијализовали сте локални репозиторијум на свом рачунару, прешли сте на нови *Branch* под називом `ssu`, додали сте измену (ишли сте *copy-paste* ваше ССУ документе у фолдер `doc/projekat/ssu`) и нисте покренули тестове (на пример немате инсталиран *Node.js*). Као што смо већ рекли, локално покретање тестова није неопходно.

Даље додајете све фајлове командом `git add .` и затим кад укуцате `git status` треба да видите фајлове које сте додали означене зеленом бојом. Онда куцате `git commit -m "Dodavanje ssu dokumenata"` (напомена: ово је скраћена верзија комита у којој уносите само наслов, а не и опис. У том случају треба да унесете опис у сам *Pull request* кад га будете отварали). Ако поново укуцате `git status`, не би требало да видите ни један фајл који сте додали у оквиру резултата те команде.

На крају, да бисте послали измене куцате `git push -u o ssu`

#### 3.3.2.5. Отварање *Pull request*-а

##### 3.3.2.5.1. Поређење *Branch*-ева

Након што сте додали измене, уђите на страницу свог форкованог репозиторијума и кликните *New pull request* (то можете учинити и са странице главног репозиторијума, рекли смо у претходним секцијама да то није битно). Само водите рачуна да подесите *Compare* као на слици:

![](https://user-images.githubusercontent.com/48075008/54887635-b7aa5d80-4e95-11e9-9009-049b504c2064.png)

Питање 1: Мени уопште не пише ово са десне стране, имам само `base` и `compare`, немам да бирам *Branch*, шта да радим?

![](https://user-images.githubusercontent.com/48075008/54887688-4028fe00-4e96-11e9-9493-25b466b56ade.png)

Одговор 1: Кликните на `compare across forks`

##### 3.3.2.5.2. Писање наслова и описа

Кад подесите као на претходној слици, кликните на `Create pull request`

![](https://user-images.githubusercontent.com/48075008/54887738-aada3980-4e96-11e9-8066-6d3afc4d0a39.png)

Отвориће вам се едитор где можете писати наслов и опис. Наслов би требало аутоматски да се постави на наслов комита, али ако има смисла можете променити наслов. Такође, ако нисте додали опис у самом комиту, требало би да додате опис у *Pull request*-у. На крају још једном кликнете `Create pull request`, овог пута дугме је са доње десне стране испод описа:

![](https://user-images.githubusercontent.com/48075008/54887819-731fc180-4e97-11e9-852d-5ec2e171e7db.png)

#### 3.3.2.6. Покретање *Travis*-а

*Travis* континуална интеграција покреће се аутоматски и обично траје неколико минута (наравно у зависности од броја тестова).

#### 3.3.2.7. Исправљање грешака након неуспешних тестова

Претпоставили смо да нисте покренули локалне тестове и да је континуална интеграција детектовала грешку. У том случају добићете овакав екран:

![](https://user-images.githubusercontent.com/48075008/54887894-2b4d6a00-4e98-11e9-9da4-e7f72e74ac95.png)

Да проверите зашто је тест пао, кликнете на `Details` са десне стране теста који није прошао (на овој слици имамо само један тест). Отвориће се *Travis* конзола:

![](https://user-images.githubusercontent.com/48075008/54887959-d78f5080-4e98-11e9-9bc3-adf46b201cf5.png)

У овом конкретном примеру проблем је неисправан прелаз између линија (до детаља смо у више секција већ објаснили зашто настаје овај проблем и како га решити). Дакле, прво што урадите након што сте видели да тест није прошао је да у конзоли на вашем рачунару пређете на *Branch* у који желите да додајете измене:

```
git checkout ssu
```

Напомена 1: овде не треба параметар `-b`. Он служи за креирање новог *Branch*-а, а ви сте већ креирали *Branch* `ssu`<br/>
Напомена 2: у овом конкретном случају ова команда је сувишна јер имате само један *Branch* (изузев главног) и већ се налазите на овом *Branch*, тако да нема потребе прелазити на исти *Branch*, али је добро да ово куцате сваки пут пре рада на некој измени да будете сигурни да се налазите на исправном *Branch*-у.

Затим исправљате грешку у свом локалном репозиторијуму (пише у секцији 3.1. како се ова конкретна грешка исправља). Кад исправите све фајлове (линтер пријављује грешку само за један фајл, јер чим дође до прве грешке он даље не проверава, тако да ако сте додали више фајлова и један од њих има ову *CRLF* грешку, онда практично сигурно и други фајлови имају ту исту грешку, па је боље да одмах исправите све фајлове које сте додали).

Онда из командне линије куцате `git status` (као што смо више пута рекли ова команда није неопходна, али вам помаже да видите у ком стању се налази тренутни *Branch*). Требало би да сви фајлови које сте додали буду означени црвеном бојом. Онда куцате:

```
git add .
git commit -m "Ispravljanje CRLF greske"
git push o ssu
```

Напомена: ове три команде су све што куцате, дакле не креирате нови *Branch* нити нови *Pull request*. Након овога кад уђете на страницу свог *Pull request*-а, видећете да је додат нови комит и да се *Travis* поново покренуо (некад мора да се сачека неколико секунди).

Када се заврше сви тестови треба да изгледа овако:

![](https://user-images.githubusercontent.com/48075008/54888150-d3fcc900-4e9a-11e9-93db-9df400d25a52.png)

Питање 1: Зар морам сваки пут да исправљам ову *CRLF* грешку за сваки фајл који додајем и сваку измену коју правим?<br/>
Одговор 1: Не, ова грешка се дешава, као што смо већ објаснили, само уколико сте ваше фајлове писали у *Github*-овом текст едитору у интернет претраживачу и касније само ишли *copy-paste* у ваш локални репозиторијум. Ако додајете нове фајлове треба да пишете у неком едитору текста, а већина едитора текста по правилу поставља *CRLF* као подразумевани прелаз ако радите на *Windows* оперативном систему.

### 3.3.3. Друга измена

Отворили сте први *Pull request*, сви тестови су прошли и сада чекате остале чланове тима да одобре ваше измене. У међувремену приметили сте неку грешку у неком другом документу (правописна грешка) и желите то одмах да исправите (јер према концептима агилних методологија развоја софтвера свако треба одмах да исправља грешку коју уочи, а не да чека да неко други то уради). Зато сте одлучили да направите нову измену и нови *Pull request* иако ваш претходни *Pull request* још није укључен у пројекат.

#### 3.3.3.1. Измена у локалном репозиторијуму

Да бисте направили нову измену прво треба да направите нови *Branch*. Из командне линије куцате:

```
git checkout -b ispravka
```

На овај начин креирате нови *Branch*. Сада можете исправити документ који желите у неком едитору текста (никако немојте то радити из интернет претраживача на *Github* сајту, да не би дошло до већ поменутих проблема).

Напомена: приметићете да су документи које сте додали на свој први *Branch* под називом `ssu` нестали из директоријума `doc/projekat/ssu`. То је зато што сте сада на новом *Branch*-у који је синхронизован са главним репозиторијумом, а у главни репозиторијум још није укључена ваша измена. Ваши документи су и даљу у локалном `ssu` *Branch*-у.

#### 3.3.3.2. Слање измене у форкован репозиторијум

Када сте креирали нови *Branch* под називом `ispravka` и у едитору текста исправили грешку коју сте приметили, сачувајте фајл и из командне линије куцајте:

```
git add .
git commit -m "Ispravljanje pravopisne greske"
git push -u o ispravka
```

#### 3.3.3.3. Отварање новог *Pull request*-а

Сада можете отворити нови *Pull request* на исти начин као што је описано у секцији 3.3.2.5.

### 3.3.4. Ажурирање првог *Pull request*-а

#### 3.3.4.1. Прелазак на стари *Branch*

Претпоставимо да су и на другом *Pull request*-у који сте отворили прошли сви тестови. Сада треба да сачекате да остали чланови тима одобре ваше *Pull request*-ове. Међутим, неки члан тима је приметио неки пропуст (на пример нека ситна правописна грешка) у вашем првом *Pull request*-у (то је онај за ССУ документе).

Да бисте исправили ту грешку, треба из командне линије прво да пређете на `ssu` *Branch* командом:

```
git checkout ssu
```

Напомена: чак и да сте већ били на том *Branch*-у, не би било лоше да то укуцате поново за сваки случај, да не бисте грешком додали измене у погрешан *Branch*, јер је то касније проблематично исправити. Да бисте проверили на ком *Branch*-у се налазите, можете куцати `git branch`

Напомена: Као што је већ речено, овде не иде параметар `-b`, он се користи само када први пут креирате нови *Branch*

#### 3.3.4.2. Исправљање грешке

Грешку чију исправку вам је предложио други члан тима исправљате у текст едитору. Након што сачувате фајл, из командне линије куцате:

```
git add .
git commit -m "..."
git push o ssu
```

Када уђете на страницу вашег првог *Pull request*-а требало би да видите нови комит и да се *Travis* поново покрене. Члан тима који вам је предложио измену добиће обавештење да сте исправили грешку и одобриће ваш *Pull request*. Када сви чланови тима одобре, тај *Pull request* ће бити одмах укључен у пројекат.

### 3.3.5. Први *Pull request* је укључен у пројекат

Сви тестови су прошли, сви чланови тима су одобрили и ваш *Pull request* је успешно укључен у пројекат. Преостале су акције брисања локалног *Branch*-а и *Branch* у форкованом репозиторијуму. То све треба да урадите из командне линије (иако *Github* нуди дугме `Delete branch`, већ смо објаснили зашто то не треба користити).

Као што пише у секцији 2.5.4, прво се брише удаљени, а затим и локални *Branch* следећим командама:

```
git checkout ssu
git push --delete o ssu
git checkout master
git branch -D ssu
```

### 3.3.6. Други *Pull request* је укључен у пројекат

Као и у претходном случају, треба да обришете удаљени и локални *Branch* који су били повезани са тим *Pull request*-ом (значи све исто, само уместо `ssu` куцате назив тог новог *Branch*-а - у овом случају назив је био `ispravka`).

## 4. Додатне напомене

### 4.1. Надзор главног репозиторијума

Сваки члан тима требало би да врши надзор главног репозиторијума како би благовремено добијао обавештења о изменама. То радите тако што кликнете на дугме `Watch` у горњем десном углу главног репозиторијума:

![](https://user-images.githubusercontent.com/48075008/54889598-9cdfe500-4ea5-11e9-871b-93336be49a05.png)

Битно је да то урадите са главног репозиторијума, а не свог форкованог репозиторијума, јер се сви *Pull request*-ови отварају на главном репозиторијуму.

Након што сте укључили надзор, добијаћете обавештења мејлом за све што се дешава на главном репозиторијуму. Када добијете обавештење да је неко одтворио *Pull request*, требало би да што је пре могуће оцените тај *Pull request* (погледати секцију 2.5.3) како би измене што пре могле бити укључене у пројекат. Наравно, прво треба да сачекате да тестови прођу, уколико некоме нису прошли тестови, нема много смисла давати било какав коментар.

### 4.2. *Issue*

Осим *Pull request*-ова, постоји и картица *Issues*, где можете отварати дебату на било коју тему везану за пројекат. *Issue* отварате тако што кликнете на картицу *Issues* из главног репозиторијума, а затим на дугме *New issue*.<br/>Ово је линк ка тој страници: <https://github.com/psi-projekat/psi-projekat/issues>

Да бисте отворили *Issue* није потребно да правите било какву измену (за разлику од *Pull request*-а), већ само кликнете на *New issue* и можете у едитору који се отвори писати наслов и опис. Опис се наравно пише у `markdown` формату и имате картице *Write* и *Preview* које вам омогућавају да куцате текст и да видите како ће то на крају изгледати.

Примери неких *Issue* које можете отворити су:

1. Нешто не ради како треба, али нисте сигурни како то исправити
2. Приметили сте неку грешку, али је она исувише сложена или није у домену онога на чему тренутно радите, већ то треба да исправи неко други
3. Имате генерално питање шта и како би даље требало радити, како нешто имплементирати, како би било најбоље нешто реализовати, итд.
4. Неки део кода вам делује сумњиво и ви мислите да у неким ситуацијама тај код неће радити како треба, али нисте сигурни у то
5. Није вам јасно нешто у документацији или мислите да може бити боље појашњено
6. Настали су неки непредвиђени проблеми током рада на пројекту
7. Имате техничких проблема око рада са неким од програма
8. Било која друга ситуација која није овде наведена, а имало би смисла о томе дискутовати

Пожељно је да пре сваког *Pull request*-а који за циљ има исправљање неке грешке прво отворите нови *Issue* где бисте објаснили шта је проблем и зашто је то потребно решити, затим кад отворите *Pull request* у опису додајте линк ка *Issue* који сте отворили. Ово има смисла само за неке озбиљније исправке багова. Такође, сваки *Pull request* који исправља неку грешку која је отворена у виде *Issue* треба да садржи линк ка том *Issue*. Можете исправљати своје *Issue*, али и туђе *Issue*.

*Issue* представља проблем или тему за дебату. У интересу свих чланова тима је да *Issue* буде затворен што пре и да проблем који је ту описан буде што пре разрешен.

Напомена: Уколико вам у овом документу нешто није јасно, погрешно је написано или мислите да може бити написано боље, отворите нови *Issue*.

### 4.3. Обавештења

Након што укључите надзор главног репозиторијума, добијаћете мејлове за сваку измену и сваку конверзацију унутар репозиторијума. Не би требало да одговарате на мејл који добијете у *Inbox*-у, већ уђите на *Github* страницу која је у питању (односно *Issue* или *Pull request*) и ту евентуално оставите коментар.

Постоји више разлога због којих није добро одговарати на мејл директно, већ треба писати коментаре на *Github* страници:

* *Inbox* не форматира слике, линкове, табеле и остале елементе коментара на исправан начин
* Ако додате неки *Attachment* на мејл (слику или фајл), он се неће приказати на *Github*-у и други то неће моћи да виде
* На *Github* страници можете видети нове комите (ако је у питању *Pull request*) и можете вршити преглед и оцену *Pull request*-ова